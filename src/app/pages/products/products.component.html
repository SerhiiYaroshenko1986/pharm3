<div class="min-h-screen p-6 bg-gray-50" style="padding-top: 180px;"> <!-- Adjust padding for header + search -->

  <div *ngIf="loading" class="flex-1 flex items-center justify-center">
    <span class="text-green-600 text-xl font-semibold animate-pulse">Завантаження...</span>
  </div>

  <div *ngIf="!loading" class="products-container">
    <!-- Sidebar: categories -->
    <aside class="products-sidebar">
      <div class="bg-white rounded-xl shadow p-6 h-full">
        <h3 class="text-lg font-semibold mb-4">Категорії</h3>
        <ul class="space-y-2">
          <li *ngFor="let cat of categories">
            <button
              (click)="selectCategory(cat.name)"
              [class]="(selectedCategory === cat.name ? 'bg-green-100 text-green-800 font-bold' : 'hover:bg-gray-100') + ' w-full text-left px-4 py-2 rounded transition-colors'">
              {{ cat.name }}
              <span *ngIf="selectedCategory === cat.name" class="float-right text-green-600 font-bold">✓</span>
            </button>
          </li>
        </ul>
      </div>
    </aside>

    <!-- Products grid -->
    <section class="products-grid">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 justify-items-center">
        <ng-container *ngFor="let product of filteredProducts">
          <div
            class="p-6 bg-white rounded-xl shadow p-4 flex flex-col justify-between items-center text-center h-[400px] w-[250px] max-w-[300px]
                   border border-gray-200 hover:shadow-lg hover:border-green-300 transition-colors overflow-hidden">
            <div class="flex flex-col items-center">
              <img [src]="product.image" [alt]="product.name" class="w-24 h-24 object-cover mb-3 rounded">
              <h3 class="text-lg font-semibold text-green-800 mb-2 min-h-[2rem]">{{ product.name }}</h3>
              <p class="text-gray-600 mb-2 min-h-[2.5rem] text-sm">{{ product.description }}</p>
              <div class="text-xs text-gray-500 mb-1" *ngIf="product.dosage">{{ product.dosage }}</div>
              <div class="text-xs text-gray-500 mb-1" *ngIf="product.manufacturer">Виробник: {{ product.manufacturer }}</div>
              <div class="text-xs text-gray-500 mb-1" *ngIf="product.country">Країна: {{ product.country }}</div>
            </div>
            <div class="mt-3 flex flex-col items-center w-full">
              <span class="text-lg font-bold text-green-700">{{ product.price }} грн</span>
              
              <!-- Available button -->
              <button
                *ngIf="product.available"
                class="w-full mt-3 px-6 py-2 bg-green-500 hover:bg-green-600 text-white rounded-xl font-semibold text-sm transition-colors shadow-lg"
                (click)="addToCart(product)">
                Купити
              </button>
              
              <!-- Not available button -->
              <button
                *ngIf="!product.available"
                class="w-full mt-3 px-6 py-2 bg-gray-400 text-gray-600 rounded-xl font-semibold text-sm cursor-not-allowed shadow-lg border border-gray-300"
                disabled>
                Немає в наявності
              </button>
            </div>
          </div>
        </ng-container>
        
        <!-- show empty state if no items -->
        <div *ngIf="filteredProducts.length === 0" class="col-span-full text-center text-gray-500 py-12">
          Товари не знайдено в цій категорії.
        </div>
      </div>
    </section>
  </div>
</div>
